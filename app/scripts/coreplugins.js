org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.conceptselector-1.1/editor/semantic-ui-tree-picker.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.conceptselector-1.1/editor/semantic-ui-tree-picker.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.assetbrowser-1.2/editor/libs/angular-inview.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.assetbrowser","ver":"1.2","shortId":"assetbrowser","author":"Sunil A S","title":"Asset Browser","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/recorder/wave/wavesurfer.min.js"},{"type":"js","src":"editor/recorder/angular-audio-recorder.js"},{"type":"js","src":"editor/libs/angular-inview.js"}],"views":[{"template":"./assetBrowser.html","controller":"./assetbrowserapp.js"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"assetbrowser",initData:void 0,cb:void 0,initialize:function(){var e=this;org.ekstep.contenteditor.api.addEventListener(this.manifest.id+":show",this.initPreview,this);var t=org.ekstep.contenteditor.api.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assetBrowser.html"),i=org.ekstep.contenteditor.api.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assetbrowserapp.js");org.ekstep.contenteditor.api.getService("popup").loadNgModules(t,i)},initPreview:function(e,t){var i=this;this.cb=t.callback,this.mediaType=t.type,this.search_filter=t.search_filter,org.ekstep.contenteditor.api.getService("popup").open({template:"partials/assetbrowser.html",controller:"browsercontroller",controllerAs:"$ctrl",resolve:{instance:function(){return i}},showClose:!1,className:"ngdialog-theme-plain"})},getAsset:function(e,t,i,r,o){var s,n;s={request:{filters:{mediaType:t,contentType:"Asset",compatibilityLevel:{min:1,max:2},status:new Array("Live","Review","Draft")},limit:50,offset:r}},org.ekstep.contenteditor.api._.isUndefined(e)||(s.request.query=e),org.ekstep.contenteditor.api._.isUndefined(i)?(s.request.filters.license="Creative Commons Attribution (CC BY)",n=org.ekstep.contenteditor.api._.omit(this.search_filter,["mediaType","license","limit"])):(s.request.filters.createdBy=i,n=org.ekstep.contenteditor.api._.omit(this.search_filter,["mediaType","limit","createdBy"])),org.ekstep.contenteditor.api._.merge(s.request.filters,n);org.ekstep.contenteditor.api.getService(ServiceConstants.SEARCH_SERVICE);ecEditor.getService("search").search(s,function(e,t){e||"OK"!=t.data.responseCode?o(e,null):o(null,t)})},showAssetBrowser:function(e,t){},fileValidation:function(e,t,i){if(window.File&&window.FileList&&window.Blob){var r=org.ekstep.contenteditor.api.jQuery("#"+e)[0].files[0].size,o=org.ekstep.contenteditor.api.jQuery("#"+e)[0].files[0].type;return r>t?(alert("File size is higher than the allowed size!"),!1):!o||(-1!=org.ekstep.contenteditor.api.jQuery.inArray(o,i)||(alert("File type is not allowed!"),!1))}return!0}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.contenteditorfunctions","ver":"1.2","author":"Sunil A S","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"plugin","plugin":"org.ekstep.toaster","ver":"1.0"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({editorState:void 0,telemetryService:org.ekstep.contenteditor.api.getService(ServiceConstants.TELEMETRY_SERVICE),lastSaved:void 0,popUpValues:{},isSaveNotificationPopupOpened:!1,contentService:org.ekstep.contenteditor.api.getService(ServiceConstants.CONTENT_SERVICE),popupService:org.ekstep.contenteditor.api.getService(ServiceConstants.POPUP_SERVICE),conflictdialogOptions:{showPlatformPreview:!1},initialize:function(){var e=this;ecEditor.addEventListener("org.ekstep.editorstate:state",this.setEditorState,this),ecEditor.addEventListener("org.ekstep.contenteditor:save",this.resolveSaveFn,this),ecEditor.addEventListener("org.ekstep.contenteditor:save:meta",this.saveMetadata,this),ecEditor.addEventListener("org.ekstep.contenteditor:preview",function(t,o){e.previewContent(o.fromBeginning)},this),ecEditor.addEventListener("org.ekstep.contenteditor:save:force",this.saveBrowserContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:review",this.reviewContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:publish",this.publishContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:reject",this.rejectContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:acceptFlag",this.acceptContentFlag,this),ecEditor.addEventListener("org.ekstep.contenteditor:discardFlag",this.discardContentFlag,this),ecEditor.addEventListener("org.ekstep.contenteditor:retire",this.retireContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:unlistedPublish",this.unlistedPublishContent,this)},setEditorState:function(e,t){t&&(this.editorState=t)},reviewContent:function(e,t){var o=ecEditor.getContext("contentId");ecEditor.getService(ServiceConstants.CONTENT_SERVICE).sendForReview({contentId:o,channel:ecEditor.getContext("channel")},function(e,o){o&&o.data&&"OK"==o.data.responseCode?(ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content sent for review...",position:"topCenter",icon:"fa fa-check-circle"}),t&&t(e,o)):(ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Sending for review failed, please try again later...",position:"topCenter",icon:"fa fa-warning"}),t&&t(e,o))})},resolveSaveFn:function(e,t){switch(ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId")).mimeType){case"application/vnd.ekstep.ecml-archive":this.saveContent(e,t),this.conflictdialogOptions.showPlatformPreview=!0;break;case"application/vnd.ekstep.content-collection":this.saveCollectionContent(e,t);break;case"application/vnd.ekstep.html-archive":case"application/vnd.ekstep.h5p-archive":case"application/epub":case"video/mp4":case"application/pdf":case"video/x-youtube":case"video/webm":case"text/x-url":this.saveGenericEditorContent(e,t);break;default:t.callback&&t.callback("unable to resolve save call for the mimetype")}},saveGenericEditorContent:function(e,t){var o=ecEditor._.assign({savingPopup:!0,successPopup:!0,failPopup:!0},t);o.savingPopup&&this.saveNotification("saving"),this._patchContent(t,t.body,o)},saveContent:function(e,t){console.log("Save invoked:",e,t),t=ecEditor._.assign({savingPopup:!0,successPopup:!0,failPopup:!0,callback:function(){}},t),t.savingPopup&&this.saveNotification("saving");var o={};t.contentMeta&&(o=t.contentMeta),org.ekstep.pluginframework.eventManager.dispatchEvent("content:before:save");var i=org.ekstep.contenteditor.stageManager.toECML();"function"==typeof org.ekstep.contenteditor.stageManager.updateStageIcons?o.stageIcons=JSON.stringify(org.ekstep.contenteditor.stageManager.updateStageIcons()):o.stageIcons=JSON.stringify(org.ekstep.contenteditor.stageManager.getStageIcons());var n=org.ekstep.contenteditor.stageManager.getSummary();if(n){o.totalQuestions=n.totalQuestions,o.totalScore=n.totalScore;var a=ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId"));ecEditor._.isEqual(ecEditor._.map(n.questions,"identifier").sort(),ecEditor._.map(a.questions,"identifier").sort())||(o.questions=n.questions)}o.assets=ecEditor._.compact(org.ekstep.contenteditor.stageManager.assets),o.editorState=JSON.stringify(this.editorState),o.pragma=org.ekstep.contenteditor.stageManager.getPragma(),this._patchContent(o,i,t)},_patchContent:function(e,t,o){var i=this;e&&(e=JSON.parse(angular.toJson(e))),this.patchContent(e,t,function(e,t){if(e)t&&!ecEditor._.isUndefined(t.responseJSON)?"ERR_STALE_VERSION_KEY"==t.responseJSON.params.err?i.showConflictDialog(o):i.changePopupValues("error"):o&&o.failPopup&&(o.savingPopup||i.saveNotification(),i.changePopupValues("error"));else if(t&&"OK"==t.data.responseCode){var n=ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId"));if("application/vnd.ekstep.content-collection"===n.mimeType&&org.ekstep.services.stateService.state.dialCodeMap){var a=_.get(org.ekstep.services.stateService.state.dialCodeMap,ecEditor.getContext("contentId"));_.isUndefined(a)||(i.dialcodeLink([{dialcode:a,identifier:ecEditor.getContext("contentId")}]),i.storeDialCodes(ecEditor.getContext("contentId"),a),_.unset(org.ekstep.services.stateService.state.dialCodeMap,ecEditor.getContext("contentId")))}o&&o.successPopup&&(o.savingPopup||i.saveNotification(),i.changePopupValues("success")),ecEditor.dispatchEvent("org.ekstep.contenteditor:after-save",{})}"function"==typeof o.callback&&o.callback(e,t)},o)},saveBrowserContent:function(e,t){var o=this;this.fetchPlatformContentVersionKey(function(i){o.resolveSaveFn(e,t)})},patchContent:function(e,t,o,i){var n=this;if(org.ekstep.contenteditor.migration&&org.ekstep.contenteditor.migration.isMigratedContent()){e||(e={}),e.oldContentBody=org.ekstep.contenteditor.migration.getBackupContent();var a=function(a,s){s&&n.contentService.saveContent(org.ekstep.contenteditor.api.getContext("contentId"),e,t,o),a&&i&&i.callback("save action interrupted by user")};n.showMigratedContentSaveDialog(a)}else n.contentService.saveContent(org.ekstep.contenteditor.api.getContext("contentId"),e,t,o)},saveMetadata:function(e,t){this._patchContent(t.contentMeta,void 0,t)},showMigratedContentSaveDialog:function(e){var t=this;this.popupService.open({template:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/partials/migratedContentSaveMsg.html"),controller:["$scope",function(o){o.saveContent=function(){org.ekstep.contenteditor.migration.clearMigrationFlag(),e(void 0,!0)},o.enableSaveBtn=function(){t.saveBtnEnabled=!0,e(!0,void 0)}}],showClose:!1,closeByDocument:!1,closeByEscape:!1})},saveNotification:function(e){var t=this,o={template:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/partials/saveMessage.html"),controller:["$scope",function(e){e.popUpValues=t.popUpValues,e.$on("ngDialog.opened",function(e,o){t.isSaveNotificationPopupOpened=!0})}],showClose:!1,closeByEscape:!1,closeByDocument:!1};console.log("config",o),this.changePopupValues(e),t.isSaveNotificationPopupOpened||this.popupService.open(o,function(){t.isSaveNotificationPopupOpened=!1})},changePopupValues:function(e){"success"===e?(this.popUpValues.headerMsg="Content Saved!",this.popUpValues.popUpIcon="circle check green",this.popUpValues.showCloseButton=!0,this.popUpValues.saveNotificationCloseButton="saveSuccessNotificationCloseButton"):"error"===e&&(this.popUpValues.headerMsg="Failed to save Content",this.popUpValues.popUpIcon="circle remove red",this.popUpValues.showCloseButton=!0,this.popUpValues.saveNotificationCloseButton="saveFailNotificationCloseButton"),"saving"===e&&(this.popUpValues.headerMsg="Saving content please wait...",this.popUpValues.showCloseButton=!1)},showConflictDialog:function(e){var t=this;this.popupService.open({template:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/partials/conflictDialog.html"),controller:["$scope",function(o){o.showPlatformPreview=!1,t.conflictdialogOptions.showPlatformPreview&&(o.showPlatformPreview=!0),o.previewPlatformContent=function(){t.previewPlatformContent()},o.saveBrowserContent=function(){t.saveBrowserContent(void 0,e),o.closeThisDialog()},o.previewContent=function(){t.previewContent()},o.refreshContent=function(){t.refreshContent()},o.firetelemetry=function(e,o){t.telemetryService.interact({id:"button",type:"click",subtype:"popup",target:o,pluginid:"org.ekstep.contenteditorfunctions",pluginver:"1.2",objectid:e.id,stage:ecEditor.getCurrentStage().id})},o.showAdvancedOption=!1}],className:"ngdialog-theme-plain header-conflict-dialog",showClose:!1,closeByDocument:!0,closeByEscape:!0})},previewContent:function(e){var t=!!_.isUndefined(e);org.ekstep.pluginframework.eventManager.dispatchEvent("atpreview:show",{contentBody:org.ekstep.contenteditor.stageManager.toECML(),currentStage:t})},refreshContent:function(){location.reload()},previewPlatformContent:function(){this.fetchPlatformContentBody(function(e){org.ekstep.pluginframework.eventManager.dispatchEvent("atpreview:show",{contentBody:e,currentStage:!0})})},fetchPlatformContentVersionKey:function(e){org.ekstep.contenteditor.api.getService(ServiceConstants.CONTENT_SERVICE).getContentVersionKey(org.ekstep.contenteditor.api.getContext("contentId"),function(t,o){t&&alert("Failed to get updated version key. Please report an issue."),o.versionKey&&e(o)})},fetchPlatformContentBody:function(e){org.ekstep.contenteditor.api.getService(ServiceConstants.CONTENT_SERVICE).getContent(org.ekstep.contenteditor.api.getContext("contentId"),function(t,o){if(t&&alert("Failed to get updated content. Please report an issue."),o&&o.body)try{var i=JSON.parse(o.body);e(i)}catch(e){alert("Failed to parse body from platform. Please report an issue.")}})},publishContent:function(e,t){var o=ecEditor.getContext("contentId");ecEditor.getService(ServiceConstants.CONTENT_SERVICE).publishContent({contentId:o,channel:ecEditor.getContext("channel"),data:t},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content published successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to publish content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},rejectContent:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).rejectContent({contentId:ecEditor.getContext("contentId"),channel:ecEditor.getContext("channel"),data:t},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content rejected successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to reject content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},acceptContentFlag:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).acceptContentFlag({contentId:ecEditor.getContext("contentId")},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content flag accepted successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to accept content flag, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},discardContentFlag:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).discardContentFlag({contentId:ecEditor.getContext("contentId")},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content flag discarded successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to discard content flag, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},retireContent:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).retireContent({contentId:ecEditor.getContext("contentId")},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content retired successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to retire content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},saveCollectionContent:function(e,t){t=t||{};var o=this,i={validNodes:[],invalidNodes:[]},n=org.ekstep.collectioneditor.api.getService("collection").getCollectionHierarchy();n&&(n=JSON.parse(angular.toJson(n))),console.log("contentBody",n);!function(){var e=["name","contentType","mimeType"];ecEditor._.forIn(org.ekstep.collectioneditor.cache.nodesModified,function(t,o){e.forEach(function(e){t.metadata.hasOwnProperty(e)&&t.metadata[e]?i.validNodes.push(o):i.invalidNodes.push(o)})})}();if(this.lowlightNode(i.validNodes),_.size(i.invalidNodes)>0)return t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Please update the collection details before save",position:"topCenter",icon:"fa fa-warning"}),this.hightlightNode(i.invalidNodes),t.callback&&t.callback("mandatory fields are missing in the data!"),!1;ecEditor.getService(ServiceConstants.CONTENT_SERVICE).saveCollectionHierarchy({body:n},function(e,i){i&&i.data&&"OK"==i.data.responseCode?(t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content saved successfully!",position:"topCenter",icon:"fa fa-check-circle"}),o.highlightNodeForInvalidDialCode(i,n.nodesModified),org.ekstep.collectioneditor.api.getService("collection").clearCache(),ecEditor._.forIn(i.data.result.identifiers,function(e,t){var o=ecEditor.getService(ServiceConstants.COLLECTION_SERVICE).getNodeById(t);o&&(o.data.id=e)}),ecEditor.dispatchEvent("meta:after:save",{})):e&&401===i.status&&"Unauthorized"===i.statusText?t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Your session has timed out due to inactivity. Please login to resume!",position:"topCenter",icon:"fa fa-warning"}):t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to save the content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,i)})},highlightNodeForInvalidDialCode:function(e,t){var o=this,i=[];ecEditor._.forEach(org.ekstep.services.stateService.state.invaliddialCodeMap,function(t,i){_.has(e.data.result.identifiers,i)?(delete org.ekstep.services.stateService.state.invaliddialCodeMap[i],org.ekstep.services.stateService.setState("invaliddialCodeMap",e.data.result.identifiers[i],t),org.ekstep.services.collectionService.highlightNode(e.data.result.identifiers[i]),o.storeDialCodes(e.data.result.identifiers[i],t)):(o.storeDialCodes(i,t),org.ekstep.services.collectionService.highlightNode(i))}),ecEditor._.forEach(org.ekstep.services.stateService.state.dialCodeMap,function(t,n){_.has(e.data.result.identifiers,n)?(delete org.ekstep.services.stateService.state.dialCodeMap[n],org.ekstep.services.stateService.setState("dialCodeMap",e.data.result.identifiers[n],t),i.push({identifier:e.data.result.identifiers[n],dialcode:t}),org.ekstep.services.collectionService.lowLightNode(e.data.result.identifiers[n]),o.storeDialCodes(e.data.result.identifiers[n],t)):(i.push({identifier:n,dialcode:t}),org.ekstep.services.collectionService.lowLightNode(n),o.storeDialCodes(n,t))});var n=!1;ecEditor._.forIn(t,function(t){if(t.metadata.dialcodes&&!n)n=!0;else{var o=_.find(i,function(t){return t.identifier===e.data.result.content_id});_.isUndefined(o)||(n=!0)}}),n&&o.dialcodeLink(i)},dialcodeLink:function(e){_.find(e,"dialcode");if(_.isEmpty(e))ecEditor._.isEmpty(org.ekstep.services.stateService.state.invaliddialCodeMap)||ecEditor.dispatchEvent("org.ekstep.toaster:warning",{title:"Unable to update some of the QR codes.",position:"topCenter",icon:"fa fa-warning"});else{var t={request:{content:e}};ecEditor.getService("dialcode").dialcodeLink(ecEditor.getContext("contentId"),ecEditor.getContext("channel"),t,function(e,t){e?!ecEditor._.isUndefined(e.responseJSON)&&e.responseJSON.params&&"ERR_DIALCODE_LINK"==e.responseJSON.params.err?ecEditor.dispatchEvent("org.ekstep.toaster:error",{title:e.responseJSON.params.errmsg,position:"topCenter",icon:"fa fa-warning"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{title:"QR code(s) updating failed!",position:"topCenter",icon:"fa fa-warning"}):ecEditor._.isEmpty(org.ekstep.services.stateService.state.dialCodeMap)||ecEditor._.isEmpty(org.ekstep.services.stateService.state.invaliddialCodeMap)?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"QR code(s) updated successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:warning",{title:"Unable to update some of the QR codes.",position:"topCenter",icon:"fa fa-warning"})})}},storeDialCodes:function(e,t){var o=ecEditor.getService(ServiceConstants.COLLECTION_SERVICE).getNodeById(e);o&&o.data&&(o.data.metadata.dialcodes=t)},hightlightNode:function(e){_.forEach(_.omitBy(_.uniq(e),_.isEmpty),function(e){org.ekstep.services.collectionService.highlightNode(e)})},lowlightNode:function(e){_.forEach(_.omitBy(_.uniq(e),_.isEmpty),function(e){org.ekstep.services.collectionService.lowLightNode(e)})},unlistedPublishContent:function(e,t){var o=ecEditor.getContext("contentId");ecEditor.getService(ServiceConstants.CONTENT_SERVICE).unlistedPublishContent({contentId:o},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content limited shared successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to share content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.unitmeta-1.7/editor/directives/dialCode/dialCodeDirective.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.unitmeta","ver":"1.7","author":"Kartheek Palla","title":"Collectioneditor Unit Meta plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"plugin":"org.ekstep.assetbrowser","ver":"1.2","type":"plugin"},{"plugin":"org.ekstep.topicselector","ver":"1.0","type":"plugin"},{"type":"js","src":"editor/directives/dialCode/dialCodeDirective.js"}],"views":[{"template":"./unitmeta.html","controller":"./unitmetaApp.js"}]}},eval('org.ekstep.collectioneditor.basePlugin.extend({initialize:function(){var e=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/unitmeta.html"),t=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/unitmetaApp.js");org.ekstep.collectioneditor.api.registerMetaPage({objectType:["TextBookUnit"],templateURL:e,controllerURL:t})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.contentmeta-1.5/editor/contentmeta.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.contentmeta-1.5/editor/libs/tokens.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.contentmeta-1.5/editor/libs/tokens.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.contentmeta","ver":"1.5","author":"Kartheek Palla","title":"Content Meta plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"plugin":"org.ekstep.assetbrowser","ver":"1.2","type":"plugin"},{"plugin":"org.ekstep.conceptselector","ver":"1.1","type":"plugin"},{"type":"css","src":"editor/contentmeta.css"},{"type":"css","src":"editor/libs/tokens.css"},{"type":"js","src":"editor/libs/tokens.js"}],"views":[{"template":"./contentmeta.html","controller":"./contentmetaApp.js"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({initialize:function(){var e=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/contentmeta.html"),t=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/contentmetaApp.js");org.ekstep.collectioneditor.api.registerMetaPage({objectType:["Story","Game","Collection","Worksheet","Resource"],templateURL:e,controllerURL:t})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.courseunitmeta-1.7/editor/libs/tokens.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.courseunitmeta-1.7/editor/libs/tokens.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.courseunitmeta","ver":"1.7","author":"Kartheek Palla","title":"Course Unit Meta plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"plugin":"org.ekstep.assetbrowser","ver":"1.2","type":"plugin"},{"plugin":"org.ekstep.topicselector","ver":"1.0","type":"plugin"},{"type":"css","src":"editor/libs/tokens.css"},{"type":"js","src":"editor/libs/tokens.js"},{"type":"plugin","plugin":"org.ekstep.metadata","ver":"1.3"}],"views":[{"template":"./courseunitmeta.html","controller":"./courseunitmetaApp.js"}]}},eval('org.ekstep.collectioneditor.basePlugin.extend({initialize:function(){var e=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/courseunitmeta.html"),t=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/courseunitmetaApp.js");org.ekstep.collectioneditor.api.registerMetaPage({objectType:["CourseUnit"],templateURL:e,controllerURL:t})}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.lessonplanunitmeta","ver":"1.5","author":"Sunil A S","title":"Collectioneditor lesson unit meta plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"plugin":"org.ekstep.assetbrowser","ver":"1.2","type":"plugin"}],"views":[{"template":"./lessonplanunitmeta.html","controller":"./lessonplanunitmetaApp.js"}]}},eval('org.ekstep.collectioneditor.basePlugin.extend({initialize:function(){var e=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/lessonplanunitmeta.html"),t=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/lessonplanunitmetaApp.js");org.ekstep.collectioneditor.api.registerMetaPage({objectType:["LessonPlanUnit"],templateURL:e,controllerURL:t})}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.preview","ver":"1.1","author":"Sunil A S","title":"preview","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","menu":[],"views":[{"template":"./popup.html","controller":""}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"preview",previewURL:(ecEditor.getConfig("previewURL")||"/content/preview/preview.html")+"?webview=true",contentBody:void 0,initialize:function(){ecEditor.addEventListener("atpreview:show",this.initPreview,this);var e=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/popup.html");ecEditor.getService("popup").loadNgModules(e)},initPreview:function(e,t){this.contentBody=t.contentBody,t.currentStage&&(this.contentBody.theme.startStage=ecEditor.getCurrentStage().id),ecEditor.getAngularScope().developerMode&&(this.contentBody.theme["plugin-manifest"]||(this.contentBody.theme["plugin-manifest"]={plugin:[]}),_.isArray(this.contentBody.theme["plugin-manifest"].plugin)||(this.contentBody.theme["plugin-manifest"].plugin=[this.contentBody.theme["plugin-manifest"].plugin]),this.contentBody.theme["plugin-manifest"].plugin.splice(0,0,{id:"org.ekstep.developer",ver:"1.0",type:"plugin",hostPath:org.ekstep.pluginframework.hostRepo.basePath,preload:!0})),this.showPreview(t)},showPreview:function(e){var t=this,i=null,n=(ecEditor.getService("content"),{repos:ecEditor.getConfig("pluginRepo"),showEndpage:!0}),o=ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId")),r=function(e){e.$on("ngDialog.opened",function(){var e=ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/images/editor-frame.png");ecEditor.jQuery(".preview-bgimage").css("background","url("+e+")");var i=ecEditor.jQuery("#previewContentIframe")[0];i.src=t.previewURL;var r={};i.onload=function(){var e={};r.etags=ecEditor.getContext("etags")||[],e.context={mode:"edit",contentId:ecEditor.getContext("contentId"),sid:ecEditor.getContext("sid"),uid:ecEditor.getContext("uid"),channel:ecEditor.getContext("channel")||"in.ekstep",pdata:ecEditor.getContext("pdata")||{id:"in.ekstep",pid:"",ver:"1.0"},app:r.etags.app||[],dims:r.etags.dims||[],partner:r.etags.partner||[]},ecEditor.getConfig("previewConfig")?e.config=ecEditor.getConfig("previewConfig"):e.config=n,e.metadata=o,e.data="application/vnd.ekstep.ecml-archive"==o.mimeType?t.contentBody:{},i.contentWindow.initializePreview(e)}})};if(e.parentElement){var d=_.extend(n,{showStartPage:!1,showEndPage:!1});i=ecEditor.jQuery(e.element)[0],""==i.src&&(i.src=t.previewURL),i.onload=function(){var e={},n={};e.etags=ecEditor.getContext("etags")||[],n.context={mode:"edit",contentId:ecEditor.getContext("contentId"),sid:ecEditor.getContext("sid"),uid:ecEditor.getContext("uid"),channel:ecEditor.getContext("channel")||"in.ekstep",pdata:ecEditor.getContext("pdata")||{id:"in.ekstep",pid:"",ver:"1.0"},app:e.etags.app||[],dims:e.etags.dims||[],partner:e.etags.partner||[]},ecEditor.getConfig("previewConfig")?n.config=ecEditor.getConfig("previewConfig"):n.config=d,n.metadata=o,n.data="application/vnd.ekstep.ecml-archive"==o.mimeType?t.contentBody:{},i.contentWindow.initializePreview(n)}}else ecEditor.getService("popup").open({template:"partials_org.ekstep.preview.html",controller:["$scope",r],showClose:!1,width:710,className:"ngdialog-theme-plain preview-window"})}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.telemetry","ver":"1.0","author":"Sunil A S","title":"Telemetry Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js"}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.telemetry",service:void 0,initialize:function(){this.service=ecEditor.getService("telemetry"),ecEditor.addEventListener("content:load:complete",this.registerEvents,this),ecEditor.addEventListener("content:load:complete",this.logPluginErrors,this)},registerEvents:function(){var e=this;ecEditor.addEventListener("object:selected",function(t,i){i&&i.id&&""!=i.id&&e.interactEvent("select","","plugin",i.type,i.ver,i.id)},this),ecEditor.addEventListener("object:modified",function(t,i){i&&i.id&&""!=i.id&&e.interactEvent("modify","","plugin",i.type,i.ver,i.id)},this),ecEditor.addEventListener("object:unselected",function(t,i){i&&i.id&&""!=i.id&&e.interactEvent("unselect","","plugin",i.type,i.ver,i.id)},this),ecEditor.addEventListener("object:removed",function(t,i){if(i&&i.id&&""!=i.id){var n=ecEditor.getPluginInstance(i.id);e.service.pluginLifeCycle({type:"remove",pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:n.id,assetid:n.getAttribute("asset"),stage:ecEditor.getCurrentStage().id,containerid:"",containerplugin:""})}},this),ecEditor.addEventListener("stage:removed",function(t,i){if(i&&i.stageId&&""!=i.stageId){var n=ecEditor.getPluginInstance(i.stageId);e.service.pluginLifeCycle({type:"remove",pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:n.id,assetid:n.getAttribute("asset"),stage:n.id,containerid:"",containerplugin:""})}},this),ecEditor.addEventListener("stage:delete",function(t,i){i&&i.stageId&&""!=i.stageId&&e.interactEvent("click","delete","plugin","org.ekstep.stage","1.0",i.stageId)},this),ecEditor.addEventListener("stage:duplicate",function(t,i){i&&i.stageId&&""!=i.stageId&&e.interactEvent("duplicate","","plugin","org.ekstep.stage","1.0",i.stageId)},this),ecEditor.addEventListener("stage:select",function(t,i){i&&i.stageId&&""!=i.stageId&&e.interactEvent("select","","plugin","org.ekstep.stage","1.0",i.stageId)},this),ecEditor.addEventListener("stage:reorder",function(t,i){i&&i.stageId&&""!=i.stageId&&e.interactEvent("modify","reorder","stage","org.ekstep.stage","1.0",i.stageId)},this),ecEditor.addEventListener("plugin:load",function(t,i){i&&e.service.pluginLifeCycle({type:"load",pluginid:i.plugin,pluginver:i.version,objectid:"",stage:"",containerid:"",containerplugin:""})},this),ecEditor.addEventListener("plugin:add",function(t,i){var n=ecEditor.getCurrentStage()?ecEditor.getCurrentStage().id:"";i&&e.service.pluginLifeCycle({type:"add",pluginid:i.plugin,pluginver:i.version,objectid:i.instanceId,stage:n,containerid:"",containerplugin:""})},this),ecEditor.addEventListener("plugin:error",function(t,i){var n=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,r={id:org.ekstep.contenteditor.api.getContext("contentId"),ver:!_.isUndefined(n)&&n.toString()||"0",type:"Content"};e.service.error({err:i.err,errtype:"CONTENT",stacktrace:i.stackTrace||"",object:r,plugin:{id:i.plugin,ver:i.version,category:""}})},this)},interactEvent:function(e,t,i,n,r,d){this.service.interact({type:e,subtype:t,target:i,pluginid:n,pluginver:r,objectid:d,stage:ecEditor.getCurrentStage().id})},logPluginErrors:function(e,t){var i=this,n=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,r={id:org.ekstep.contenteditor.api.getContext("contentId"),ver:!_.isUndefined(n)&&n.toString()||"0",type:"Content"},d=org.ekstep.pluginframework.pluginManager.getErrors();_.each(d,function(e){i.service.error({err:e.error,errtype:"CONTENT",stacktrace:e.stackTrace||"",object:r,plugin:{id:e.plugin,ver:e.version,category:""}})})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.toaster-1.0/editor/libs/iziToast.min.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.toaster-1.0/editor/libs/iziToast.min.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.toaster","ver":"1.0","author":"Sunil A S","title":"Toaster plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/libs/iziToast.min.js"},{"type":"css","src":"editor/libs/iziToast.min.css"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({initialize:function(t){var i={resetOnHover:!0,icon:"material-icons",onOpening:function(){},onClosing:function(){}};t=t||i,iziToast.settings(t),ecEditor.addEventListener("org.ekstep.toaster:show",this.show,this),ecEditor.addEventListener("org.ekstep.toaster:warning",this.warning,this),ecEditor.addEventListener("org.ekstep.toaster:error",this.error,this),ecEditor.addEventListener("org.ekstep.toaster:info",this.info,this),ecEditor.addEventListener("org.ekstep.toaster:success",this.success,this)},show:function(t,i){if(!i)return!1;iziToast.show(i)},warning:function(t,i){if(!i)return!1;iziToast.warning(i)},info:function(t,i){if(!i)return!1;iziToast.info(i)},success:function(t,i){if(!i)return!1;iziToast.success(i)},error:function(t,i){if(!i)return!1;iziToast.error(i)}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.breadcrumb","ver":"1.0","author":"Akash Gupta","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[],"views":[{"template":"./template.html","controller":"./breadcrumbApp.js"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({initialize:function(){var e=this,t=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/template.html"),i=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/breadcrumbApp.js");org.ekstep.collectioneditor.api.registerBreadcrumb({templateURL:t,controllerURL:i})}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.collectionkeyboardshortcuts","ver":"1.0","author":"Akash Gupta","editor":{"main":"editor/plugin.js"}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"shortcuts",initialize:function(){ecEditor.registerKeyboardCommand("alt+mod+shift+n",function(e){if("Edit"===org.ekstep.services.collectionService.config.mode)return e.preventDefault(),ecEditor.jQuery(ecEditor.jQuery("#collection-tree")).trigger("nodeCommand",{cmd:"addSibling"}),!1}),ecEditor.registerKeyboardCommand("alt+mod+a",function(e){if("Edit"===org.ekstep.services.collectionService.config.mode)return e.preventDefault(),ecEditor.jQuery(ecEditor.jQuery("#collection-tree")).trigger("nodeCommand",{cmd:"addLesson"}),!1}),ecEditor.registerKeyboardCommand(["alt+ctrl+n","alt+command+`"],function(e){if("Edit"===org.ekstep.services.collectionService.config.mode)return e.preventDefault(),ecEditor.jQuery(ecEditor.jQuery("#collection-tree")).trigger("nodeCommand",{cmd:"addChild"}),!1}),ecEditor.registerKeyboardCommand(["del","ctrl+del","mod+backspace"],function(e){if("Edit"===org.ekstep.services.collectionService.config.mode)return e.preventDefault(),ecEditor.jQuery(ecEditor.jQuery("#collection-tree")).trigger("nodeCommand",{cmd:"remove"}),!1}),ecEditor.registerKeyboardCommand("mod+/",function(e){if("Edit"===org.ekstep.services.collectionService.config.mode)return e.preventDefault(),ecEditor.jQuery(ecEditor.jQuery("#collection-tree")).trigger("nodeCommand",{cmd:"showMenu"}),!1})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.collectioneditor-1.6/dist/styles.min.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.collectioneditor-1.6/dist/script.min.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.collectioneditor","ver":"1.6","author":"Gourav More","title":"collection tree Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"dist/script.min.js"},{"type":"css","src":"dist/styles.min.css"}],"container":[{"id":"tree","templateURL":"editor/collectiontree.html","controllerURL":"editor/collectionEditorApp.js"}]}},eval('org.ekstep.collectioneditor.basePlugin.extend({initialize:function(){setTimeout(function(){ecEditor.jQuery(".popup-item").popup()},0)}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.assetbrowser-1.2/editor/recorder/wave/wavesurfer.min.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.conceptselector","ver":"1.1","author":"Santhosh Vasabhaktula","title":"Concept Selector Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/semantic-ui-tree-picker.js"},{"type":"css","src":"editor/semantic-ui-tree-picker.css"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({conceptData:[],callback:void 0,limit:500,selectors:[],concepts:[],initialize:function(){var e=this;ecEditor.addEventListener(e.manifest.id+":init",this.initConceptBrowser,this)},initData:function(e,t){function n(e,t){var i=[];return ecEditor._.forEach(t,function(c){if(void 0!=c.parent&&c.parent[0]==e){var r={};r.id=c.identifier,r.name=c.name,r.selectable="selectable",r.nodes=n(c.identifier,t),i.push(r)}}),ecEditor._.uniqBy(i,"id")}var e=e||this,i=[],c={request:{filters:{objectType:["Dimension","Domain"]}}};ecEditor.getService("search").search(c,function(c,r){!c&&r.data&&r.data.result&&ecEditor._.isArray(r.data.result.domains)?(ecEditor._.forEach(r.data.result.domains,function(t){var c={};c.id=t.identifier,c.name=t.name;var a=[];ecEditor._.forEach(n(t.identifier,r.data.result.dimensions),function(t){var i={};i.id=t.id,i.name=t.name,i.nodes=n(t.id,e.concepts),a.push(i)}),c.nodes=a,i.push(c)}),t&&t()):t&&t()}),this.conceptData=i},getConcept:function(e,t,n,i){var n=n||this;e=e||0;var c={request:{filters:{objectType:["Concept"]},offset:e,limit:t}};ecEditor.getService("search").search(c,function(c,r){!c&&r.data&&r.data.result&&ecEditor._.isArray(r.data.result.concepts)&&(ecEditor._.forEach(r.data.result.concepts,function(e){n.concepts.push(e)}),r.data.result.count>r.data.result.concepts.length+e?(e+=r.data.result.concepts.length,e!==r.data.result.count?n.getConcept(e,t,n,i):i(n)):i(n))})},initConceptBrowser:function(e,t){var n=this;n.concepts.length?-1==n.selectors.indexOf(t.element)&&setTimeout(function(){ecEditor.jQuery("#"+t.element).treePicker({data:n.conceptData,name:"Concepts",picked:t.selectedConcepts,onSubmit:function(e){t.callback(e),t.selectedConcepts=_.map(e,"id"),n.generateTelemetry({type:"click",subtype:"submit",target:"ConceptSelectorSubmit"})},onCancel:function(){n.initConceptBrowser(e,t)},nodeName:"conceptSelector_"+t.element,minSearchQueryLength:1})},1e3):n.getConcept(0,n.limit,n,function(){n.initData(n,function(){-1==n.selectors.indexOf(t.element)&&setTimeout(function(){ecEditor.jQuery("#"+t.element).treePicker({data:n.conceptData,name:"Concepts",picked:t.selectedConcepts,onSubmit:function(e){t.callback(e),t.selectedConcepts=_.map(e,"id"),n.generateTelemetry({type:"click",subtype:"submit",target:"ConceptSelectorSubmit"})},onCancel:function(){n.initConceptBrowser(e,t)},nodeName:"conceptSelector_"+t.element,minSearchQueryLength:1})},1e3)})})},generateTelemetry:function(e){var t=this;e&&ecEditor.getService("telemetry").interact({type:e.type,subtype:e.subtype,id:e.target,pageid:org.ekstep.contenteditor.api.getCurrentStage().id||"",target:{id:e.targetid||"",type:"plugin",ver:""},plugin:{id:t.manifest.id,ver:t.manifest.ver,category:"core"},ver:"3.0"})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.assetbrowser-1.2/editor/recorder/angular-audio-recorder.js', 'js')
